# Smart Credentials Deployment - Sepolia

**Version:** 1.0.0  
**Date:** December 24, 2025  
**Network:** Sepolia (Chain ID: 11155111)  
**Status:** ✅ Deployed and Verified

## Deployment Summary

This deployment includes the Smart Credentials reference implementation contracts for ERC-XXXX: Smart Credentials.

### Deployed Contracts

| Contract | Address | Verified | Notes |
|----------|---------|----------|-------|
| AgentRegistry | `0x73B983440136a121e5444b7C47c432808C2757A1` | ❌ | Mock registry for testing |
| AgentProjects | `0xD0deBFECe8EdEf0c8E2C8a88F357a442CB708C3E` | ✅ | [View on Etherscan](https://sepolia.etherscan.io/address/0xd0debfece8edef0c8e2c8a88f357a442cb708c3e) |

### Deployment Details

- **Deployer Address:** `0xF8e03bd4436371E0e2F7C02E529b2172fe72b4EF`
- **Compiler Version:** Solidity 0.8.30
- **EVM Version:** Prague
- **Total Gas Used:** ~3,384,880 gas
- **Estimated Cost:** ~0.000004 ETH

## Contract Details

### AgentRegistry

**Address:** `0x73B983440136a121e5444b7C47c432808C2757A1`  
**Source:** `src/mocks/AgentRegistry.sol`  
**Type:** Mock ERC-6909 registry for testing

A minimal ERC-6909 implementation for agent registration. This is a mock contract used for testing and development purposes.

**Features:**
- ERC-6909 token standard implementation
- Single ownership mapping (agentId => owner)
- Operator and approval support
- Minimal implementation for testing

### AgentProjects

**Address:** `0xD0deBFECe8EdEf0c8E2C8a88F357a442CB708C3E`  
**Source:** `src/credentials/AgentProjects.sol`  
**Type:** Smart Credential implementation  
**Verified:** ✅ [View on Etherscan](https://sepolia.etherscan.io/address/0xd0debfece8edef0c8e2c8a88f357a442cb708c3e)

A full-featured Smart Credential contract implementing:
- **ERC-8048**: Token-level metadata extension
- **ERCXXXXReviews**: Reviews extension with double mapping storage
- **Authorization**: ERC-6909-style authorization (owner, operator, approved)

**Constructor Arguments:**
- `agentRegistry`: `0x73B983440136a121e5444b7C47c432808C2757A1`

**Interfaces Supported:**
- `IERC165`
- `IERC8048`
- `IERCXXXXReviews`
- `IAgentProjects`

**Features:**
- Project metadata management via `setProject()`
- Peer review system via `review()`
- Authorization checks for agent owners, operators, and approved addresses
- Diamond Storage pattern for predictable storage locations

## ECS Credential Update

**Status:** ⚠️ Skipped - Deployer is not the owner

The deployment script attempted to update the `typewiki.ecs.eth` credential in the ECS Registry but was skipped because:

- **ECS Registry:** `0x1Cc0E6c3B645D7751DE7Ff7ce7d17cD228e4a4F2`
- **Label:** `typewiki.ecs.eth`
- **Current Owner:** `0x9a704664009d615A90ddDf9345B6b8B2A214cFb2`
- **Deployer:** `0xF8e03bd4436371E0e2F7C02E529b2172fe72b4EF`

**To update the credential:**

1. Use the owner account (`0x9a704664009d615A90ddDf9345B6b8B2A214cFb2`) to deploy, OR
2. Transfer ownership of `typewiki.ecs.eth` to the deployer account, OR
3. Manually update using `UpdateTypewikiResolver.s.sol` with the owner's private key

**Update Script:**
```bash
export AGENT_PROJECTS_ADDRESS=0xD0deBFECe8EdEf0c8E2C8a88F357a442CB708C3E
export UPDATE_SECRET=<secret_from_commit>
forge script script/UpdateTypewikiResolver.s.sol:UpdateTypewikiResolver \
  --rpc-url $SEPOLIA_RPC_URL \
  --broadcast -vv
```

## Usage Examples

### Set Project Metadata

```solidity
import {AgentProjects} from "./src/credentials/AgentProjects.sol";

AgentProjects projects = AgentProjects(0xD0deBFECe8EdEf0c8E2C8a88F357a442CB708C3E);

// Set project data (requires authorization)
projects.setProject(agentId, "project-name", "My Project");
```

### Submit a Review

```solidity
bytes memory reviewData = "score: 95 review: excellent work";
projects.review(reviewerId, reviewedId, reviewData);
```

### Query Functions

```bash
# Get project metadata
cast call 0xD0deBFECe8EdEf0c8E2C8a88F357a442CB708C3E \
  "getMetadata(uint256,string)(bytes)" \
  <agentId> "project-name" \
  --rpc-url $SEPOLIA_RPC_URL

# Get review
cast call 0xD0deBFECe8EdEf0c8E2C8a88F357a442CB708C3E \
  "getReview(uint256,uint256)(bytes)" \
  <reviewerId> <reviewedId> \
  --rpc-url $SEPOLIA_RPC_URL

# Check interface support
cast call 0xD0deBFECe8EdEf0c8E2C8a88F357a442CB708C3E \
  "supportsInterface(bytes4)(bool)" \
  0x01ffc9a7 \
  --rpc-url $SEPOLIA_RPC_URL
```

## Verification

**AgentProjects:** ✅ Successfully verified on Etherscan  
**Verification GUID:** `fkwcul9vul3eqk5ycwlfhnuctt8pvytb4stvvlcvn1q5rbghri`  
**Etherscan URL:** https://sepolia.etherscan.io/address/0xd0debfece8edef0c8e2c8a88f357a442cb708c3e

**AgentRegistry:** ❌ Verification failed (mock contract, not critical)

## Transaction Details

Transaction data saved to:
- `broadcast/Deploy.s.sol/11155111/run-latest.json`
- `cache/Deploy.s.sol/11155111/run-latest.json`

## Related Contracts

- **ECS Registry (Sepolia):** `0x1Cc0E6c3B645D7751DE7Ff7ce7d17cD228e4a4F2`
- **ECS Registrar (Sepolia):** `0x86a67901820da1e3523Db67d02083C0a08170b37`

## Next Steps

1. ✅ Contracts deployed and verified
2. ⚠️ Update `typewiki.ecs.eth` credential (requires owner account)
3. Test contract functionality with registered agents
4. Integrate with identity systems using ERC-XXXX Hooks

## References

- [ERC-XXXX: Smart Credentials](https://eips.ethereum.org/EIPS/eip-XXXX)
- [ERC-8048: Token Metadata Extension](https://eips.ethereum.org/EIPS/eip-8048)
- [ERC-6909: Multi Token Standard](https://eips.ethereum.org/EIPS/eip-6909)
- [ECS V2 Documentation](../../ecs/README.md)
